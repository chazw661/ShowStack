{% extends "admin/change_list.html" %}
{% load static %}

{% block result_list %}
{{ block.super }}


<!-- Add scoped styles that only affect cable summary tables -->
<style>
/* Scope all styles to cable-summary-section only */
.cable-summary-section {
    margin-top: 20px;
    padding: 15px;
    background: #2a2a2a;  /* Dark background for container */
    border: 1px solid #417690;
    border-radius: 4px;
}

.cable-summary-section h2 {
    color: #f0f0f0;
    margin-top: 0;
}

.cable-summary-section table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    background: #1e1e1e;
}

.cable-summary-section thead tr {
    background: #417690 !important;
}

.cable-summary-section thead th {
    padding: 8px;
    text-align: center;
    border: 1px solid #356683;
    color: white !important;
    background: transparent;
}

.cable-summary-section thead th:first-child {
    text-align: left;
}

.cable-summary-section tbody tr {
    background: #1e1e1e;
}

.cable-summary-section tbody td {
    padding: 8px;
    text-align: center;
    border: 1px solid #333;
    color: #f0f0f0;
}

.cable-summary-section tbody td:first-child {
    text-align: left;
    font-weight: bold;
}

.cable-summary-section .total-with-overage {
    font-weight: bold;
    color: #4a9eff !important;
}

.cable-summary-section .order-cells,
.cable-summary-section .coupler-cells {
    background: #4a4a00 !important;
    color: #ffff99 !important;
}

.cable-summary-section .grand-total-row {
    background: #333 !important;
    font-weight: bold;
}

.cable-summary-section .grand-total-row td {
    border: 2px solid #417690;
}

.cable-summary-section .quick-order-box {
    margin-top: 20px;
    padding: 10px;
    background: #2a2a2a;
    border: 1px solid #417690;
    color: #f0f0f0;
}

.cable-summary-section .quick-order-box h3 {
    color: #f0f0f0;
    margin-top: 0;
}

.cable-summary-section .quick-order-box strong {
    color: #4a9eff;
}

.cable-summary-section .quick-order-box ul {
    margin: 5px 0;
    color: #f0f0f0;
}
</style>

<div class="cable-summary-section">
    <h2>Cable Summary with Ordering Calculations</h2>
    
    <table>
        <thead>
            <tr>
                <th>Cable Type</th>
                <th>Total Runs</th>
                <th>Total Length (ft)</th>
                <th>100' QTY</th>
                <th>50' QTY</th>
                <th>25' QTY</th>
                <th>10' QTY</th>
                <th>5' QTY</th>
                <th>Couplers</th>
                </tr>
        </thead>
        <tbody>
            {% for cable_type, data in cable_summary.items %}
            <tr>
                <td>{{ cable_type }}</td>
                <td>{{ data.total_runs }}</td>
                <td>{{ data.total_length }}</td>
                <td>{{ data.hundreds }}</td>
                <td>{{ data.fifties }}</td>
                <td>{{ data.twenty_fives }}</td>
                <td>{{ data.tens }}</td>
                <td>{{ data.fives }}</td>
                <td>{{ data.couplers }}</td>
            </tr>
            {% endfor %}
        </tbody>
            
            <!-- Grand Total Row -->
                <td>-</td>
            </tr>
        </tbody>
    </table>

    
    <!-- Fan Out Summary Section -->
    {% if fan_out_summary %}
    <div class="cable-summary-section">  <!-- Use same class as cable summary -->
        <h2>Fan Out Summary</h2>  <!-- This will get the blue title bar -->
        
        <table>
            <thead>
                <tr>
                    <th>FAN OUT TYPE</th>
                    <th>TOTAL QUANTITY</th>
                </tr>
            </thead>
            <tbody>
                {% for fan_out_type, data in fan_out_summary.items %}
                <tr>
                    <td>{{ fan_out_type }}</td>
                    <td>{{ data.total_quantity }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
    
   <!-- Ordering Summary Box -->
{% if cable_summary %}
<div class="quick-order-box">
    <h3 style="font-size: 20px; font-weight: bold;">Quick Order List</h3>
    
    <!-- Cable Orders -->
    {% for cable_type, data in cable_summary.items %}
    <div style="margin-bottom: 15px; font-size: 18px;">
        <strong style="font-size: 18px; color: #79aec8;">{{ cable_type }}:</strong>  <!-- Added color here -->
        <ul style="font-size: 16px; line-height: 1.8;">
            {% if data.hundreds > 0 %}
            <li style="font-size: 16px; margin: 5px 0;">Order {{ data.hundreds }} × 100' lengths</li>
            {% endif %}
            {% if data.fifties > 0 %}
            <li style="font-size: 16px; margin: 5px 0;">Order {{ data.fifties }} × 50' lengths</li>
            {% endif %}
            <!-- ... other cable lengths ... -->
        </ul>
    </div>
    {% endfor %}
    
    <!-- Fan Out Orders -->
    {% if fan_out_summary %}
    <div style="margin-top: 20px; margin-bottom: 15px;">
        <strong style="font-size: 18px; color: #79aec8;">FAN OUTS:</strong>
        <ul style="font-size: 16px; line-height: 1.8;">
            {% for fan_out_type, data in fan_out_summary.items %}
            <li style="font-size: 16px; margin: 5px 0;">Order {{ data.with_overage }} × {{ fan_out_type }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    <!-- Note about overage -->
    {% if fan_out_summary %}
    <div style="margin-top: 20px; padding: 10px; background-color: #2a3a2a; border-left: 3px solid #417690;">
        <p style="font-size: 14px; color: #90ee90; margin: 0;">
            <strong>Note:</strong> Fan out quantities in the summary above include a 20% safety margin.
        </p>
    </div>
    {% endif %}
</div>
{% endif %}

{% endblock %}