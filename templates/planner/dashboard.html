{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}System Dashboard | Audio Patch{% endblock %}

{% block extrastyle %}
<style>
    /* Dashboard Container */
    .dashboard-container {
        padding: 20px;
        background: #0a0a0a;
        min-height: calc(100vh - 100px);
    }

    .dashboard-header {
        margin-bottom: 30px;
    }

    .dashboard-header h1 {
        color: #00ff88;
        font-size: 32px;
        margin: 0 0 10px 0;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
    }

    .dashboard-subtitle {
        color: #a0a0a0;
        font-size: 14px;
    }

    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: linear-gradient(135deg, #1a1a1a 0%, #242424 100%);
        border: 1px solid #333;
        border-radius: 8px;
        padding: 20px;
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        border-color: #00ff88;
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
        transform: translateY(-2px);
    }

    .stat-card-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }

    .stat-icon {
        font-size: 32px;
        margin-right: 12px;
    }

    .stat-title {
        color: #00ff88;
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .stat-value {
        font-size: 42px;
        font-weight: bold;
        color: #fff;
        margin-bottom: 10px;
    }

    .stat-details {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .stat-detail {
        color: #a0a0a0;
        font-size: 13px;
    }

    .stat-detail-value {
        color: #00ff88;
        font-weight: 600;
    }

    /* Recent Activity Section */
    .activity-section {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    .activity-header {
        color: #00ff88;
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #333;
    }

    .activity-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .activity-item {
        padding: 12px;
        border-bottom: 1px solid #2a2a2a;
        transition: background 0.2s;
    }

    .activity-item:hover {
        background: #242424;
    }

    .activity-item:last-child {
        border-bottom: none;
    }

    .activity-title {
        color: #fff;
        font-weight: 500;
        margin-bottom: 4px;
    }

    .activity-meta {
        color: #666;
        font-size: 12px;
    }

    /* Quick Actions */
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
    }

    .quick-action {
        background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);
        border: 2px solid #333;
        border-radius: 6px;
        padding: 15px;
        text-align: center;
        text-decoration: none;
        color: #00ff88;
        font-weight: 600;
        transition: all 0.3s ease;
        display: block;
    }

    .quick-action:hover {
        border-color: #00ff88;
        background: linear-gradient(135deg, #1a3a1a 0%, #0f2a0f 100%);
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        transform: translateY(-2px);
        color: #00ff88;
    }

    .quick-action-icon {
        font-size: 24px;
        margin-bottom: 8px;
    }

    /* Status Indicators */
    .status-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin-bottom: 30px;
    }

    .status-item {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 6px;
        padding: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        box-shadow: 0 0 10px currentColor;
    }

    .status-indicator.active {
        background: #00ff88;
        color: #00ff88;
    }

    .status-indicator.inactive {
        background: #666;
        color: #666;
    }

    .status-label {
        color: #a0a0a0;
        font-size: 13px;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 40px;
        color: #666;
    }

    .empty-state-icon {
        font-size: 48px;
        margin-bottom: 10px;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header -->
    <div class="dashboard-header">
        <h1>üéõÔ∏è System Dashboard</h1>
        <p class="dashboard-subtitle">Audio Patch Management System Overview</p>
    </div>

    <!-- System Status -->
    <div class="activity-header" style="margin-bottom: 15px;">System Status</div>
    <div class="status-grid">
        <div class="status-item">
            <span class="status-indicator {% if status_checks.has_consoles %}active{% else %}inactive{% endif %}"></span>
            <span class="status-label">Consoles</span>
        </div>
        <div class="status-item">
            <span class="status-indicator {% if status_checks.has_devices %}active{% else %}inactive{% endif %}"></span>
            <span class="status-label">I/O Devices</span>
        </div>
        <div class="status-item">
            <span class="status-indicator {% if status_checks.has_amps %}active{% else %}inactive{% endif %}"></span>
            <span class="status-label">Amplifiers</span>
        </div>
        <div class="status-item">
            <span class="status-indicator {% if status_checks.has_show_days %}active{% else %}inactive{% endif %}"></span>
            <span class="status-label">Show Days</span>
        </div>
        <div class="status-item">
            <span class="status-indicator {% if status_checks.has_comm %}active{% else %}inactive{% endif %}"></span>
            <span class="status-label">Comm System</span>
        </div>
    </div>

  <!-- Quick Actions -->
<div class="activity-header" style="margin-bottom: 15px;">Quick Actions</div>
<div class="quick-actions">
    <a href="/admin/planner/console/" class="quick-action">
        <div class="quick-action-icon">üìä</div>
        Consoles
    </a>
    
    <a href="/admin/planner/device/" class="quick-action">
        <div class="quick-action-icon">üîå</div>
        I/O Devices
    </a>
    
    <a href="/admin/planner/p1processor/" class="quick-action">
        <div class="quick-action-icon">üíª</div>
        Processors
    </a>
    
    <a href="/admin/planner/amp/" class="quick-action">
        <div class="quick-action-icon">‚ö°</div>
        Amplifiers
    </a>
    
    <a href="/admin/planner/pacableschedule/" class="quick-action">
        <div class="quick-action-icon">üîå</div>
        PA Cables
    </a>
    
    <a href="/admin/planner/commbeltpack/" class="quick-action">
        <div class="quick-action-icon">üìª</div>
        Comm System
    </a>
    
    <a href="/admin/planner/soundvisionprediction/" class="quick-action">
        <div class="quick-action-icon">üîÆ</div>
        Soundvision Predictions
    </a>
    
    <a href="/admin/planner/powerdistributionplan/" class="quick-action">
        <div class="quick-action-icon">üîã</div>
        Power Distribution
    </a>
    
    <a href="/audiopatch/mic-tracker/" class="quick-action">
        <div class="quick-action-icon">üé§</div>
        Mic Tracker
    </a>
    
    <a href="/admin/planner/audiochecklist/" class="quick-action">
        <div class="quick-action-icon">‚úÖ</div>
        Audio Checklist
    </a>
</div>

        <!-- Device Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üì¶</span>
                <span class="stat-title">I/O Devices</span>
            </div>
            <div class="stat-value">{{ device_stats.total }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    With Inputs: <span class="stat-detail-value">{{ device_stats.with_inputs }}</span>
                </div>
                <div class="stat-detail">
                    With Outputs: <span class="stat-detail-value">{{ device_stats.with_outputs }}</span>
                </div>
            </div>
        </div>

        <!-- Processor Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üñ•Ô∏è</span>
                <span class="stat-title">Processors</span>
            </div>
            <div class="stat-value">{{ processor_stats.total }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    P1: <span class="stat-detail-value">{{ processor_stats.p1 }}</span>
                </div>
                <div class="stat-detail">
                    Galaxy: <span class="stat-detail-value">{{ processor_stats.galaxy }}</span>
                </div>
            </div>
        </div>

        <!-- Amp Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">‚ö°</span>
                <span class="stat-title">Amplifiers</span>
            </div>
            <div class="stat-value">{{ amp_stats.total }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    Locations: <span class="stat-detail-value">{{ amp_stats.locations }}</span>
                </div>
                <div class="stat-detail">
                    Channels: <span class="stat-detail-value">{{ amp_stats.channels }}</span>
                </div>
            </div>
        </div>

        <!-- PA Cable Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üîå</span>
                <span class="stat-title">PA Cables</span>
            </div>
            <div class="stat-value">{{ pa_cable_stats.cable_runs }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    Zones: <span class="stat-detail-value">{{ pa_cable_stats.zones }}</span>
                </div>
                <div class="stat-detail">
                    Total Cables: <span class="stat-detail-value">{{ pa_cable_stats.total_cables }}</span>
                </div>
            </div>
        </div>

        <!-- Mic Tracker Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üé§</span>
                <span class="stat-title">Mic Tracking</span>
            </div>
            <div class="stat-value">{{ mic_stats.assignments }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    Sessions: <span class="stat-detail-value">{{ mic_stats.sessions }}</span>
                </div>
                <div class="stat-detail">
                    Currently Mic'd: <span class="stat-detail-value">{{ mic_stats.micd }}</span>
                </div>
                <div class="stat-detail">
                    Shared: <span class="stat-detail-value">{{ mic_stats.shared }}</span>
                </div>
            </div>
        </div>

        <!-- Comm Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üìª</span>
                <span class="stat-title">Comm System</span>
            </div>
            <div class="stat-value">{{ comm_stats.total_packs }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    Wireless: <span class="stat-detail-value">{{ comm_stats.wireless }}</span>
                </div>
                <div class="stat-detail">
                    Hardwired: <span class="stat-detail-value">{{ comm_stats.hardwired }}</span>
                </div>
                <div class="stat-detail">
                    Checked Out: <span class="stat-detail-value">{{ comm_stats.checked_out }}</span>
                </div>
            </div>
        </div>

        <!-- Power Distribution Stats -->
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-icon">üîã</span>
                <span class="stat-title">Power Distribution</span>
            </div>
            <div class="stat-value">{{ power_stats.plans }}</div>
            <div class="stat-details">
                <div class="stat-detail">
                    Amps in Plans: <span class="stat-detail-value">{{ power_stats.amps_in_plans }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <!-- Recent Show Days -->
        <div class="activity-section">
            <div class="activity-header">Recent Show Days</div>
            {% if recent_show_days %}
            <ul class="activity-list">
                {% for show_day in recent_show_days %}
                <li class="activity-item">
                    <div class="activity-title">
                        <a href="{% url 'admin:planner_showday_change' show_day.id %}" style="color: #00ff88;">
                            {{ show_day.name }}
                        </a>
                    </div>
                    <div class="activity-meta">
                        {{ show_day.date|date:"M d, Y" }}
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">üìÖ</div>
                <p>No show days yet</p>
            </div>
            {% endif %}
        </div>

        <!-- Recent Cable Runs -->
        <div class="activity-section">
            <div class="activity-header">Recent Cable Runs</div>
            {% if recent_cables %}
            <ul class="activity-list">
                {% for cable in recent_cables %}
                <li class="activity-item">
                    <div class="activity-title">
                        <a href="{% url 'admin:planner_pacableschedule_change' cable.id %}" style="color: #00ff88;">
                            {{ cable.label }} ‚Üí {{ cable.destination }}
                        </a>
                    </div>
                    <div class="activity-meta">
                        {{ cable.count }} x {{ cable.cable }} @ {{ cable.length }}'
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">üîå</div>
                <p>No cable runs yet</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}